{"version":3,"sources":["launchpad.js"],"names":["$","Observable","this","observers","prototype","on","event","callback","push","emit","args","Array","slice","call","arguments","forEach","apply","undefined","window","launchpad","Button","channel","note","midiAdapter","id","isControl","x","y","Math","floor","Object","create","constructor","turn","color","paint","defaults","paintNames","colors","extend","red","green","velocity","send","selectItem","name","from","items","item","next","done","value","orange","sysex","midiAdapterFactory","accept","reject","navigator","requestMIDIAccess","padName","then","midiAccess","input","inputs","values","output","outputs","io","MidiAdapter","Launchpad","pad","reduce","result","dictionary","key","hasOwnProperty","connect","options","Promise","bind","onmidimessage","onMidiMessageCallback","message","data","inputHandlers","applies","handle","buttonLookups","length","lookup","Pad","handleInput","filter","handler","clear","button","buttonLookup","map","controlButton","version"],"mappings":"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","file":"launchpad.min.js","sourcesContent":[";(function($){\n    var Observable = $.Observable = function(){\n        this.observers = {};\n    };\n    Observable.prototype.on = function(event, callback){\n        if (typeof callback !== 'function') return;\n        (this.observers[event] = this.observers[event] || []).push(callback);\n    };\n    Observable.prototype.emit = function(event){\n        var args = Array.prototype.slice.call(arguments, 1);\n        (this.observers[event] || []).forEach(function(callback){\n            callback.apply(undefined, args);\n        });\n    }\n})(window.launchpad = window.launchpad || {});\n;;(function($){\n    var Button = $.Button = function(channel, note, midiAdapter){\n        $.Observable.call(this);\n        this.channel = channel;\n        this.note = note;\n        this.midiAdapter = midiAdapter;\n        this.id = this.note;\n        if (!this.isControl()) {\n            this.x = this.note % 16;\n            this.y = Math.floor(this.note / 16);\n        } else {\n            this.id -= 104;\n        }\n    };\n    Button.prototype = Object.create($.Observable.prototype);\n    Button.prototype.constructor = Button;\n    Button.prototype.turn = function(color){\n        this.paint($.defaults.paintNames[color]);\n    };\n    Button.prototype.paint = function(colors){\n        colors = $.extend(colors, { 'red': 0, 'green': 0 });\n        var velocity = (colors.green % 4) * 16 + (colors.red % 4);\n        this.send(velocity);\n    }\n    Button.prototype.send = function(velocity){\n        this.midiAdapter.send(this.channel, this.note, velocity);\n    };\n    Button.prototype.isControl = function(){\n        return this.channel === 176;\n    };\n})(window.launchpad = window.launchpad || {});\n;;(function($, undefined){\n    var defaults = $.defaults = {};\n\n    function selectItem(name){\n        return {\n            'from': function(items){\n                var item = items.next();\n                while (!item.done) {\n                    if (item.value.name === name) {\n                        return item.value;\n                    }\n                    item = items.next();\n                }\n                return undefined;\n            }\n        }\n    };\n\n    defaults.paintNames = {\n        'red':    { 'red': 3, 'green': 0 },\n        'green':  { 'red': 0, 'green': 3 },\n        'orange': { 'red': 3, 'green': 3 },\n    };\n    defaults.name = 'Launchpad Mini';\n    defaults.sysex = false;\n    defaults.midiAdapterFactory = function(accept, reject){\n        if (!navigator.requestMIDIAccess){\n            reject();\n        } else {\n            var padName = this.name;\n            navigator.requestMIDIAccess({ sysex: this.sysex })\n                .then(function(midiAccess){\n                    return {\n                        'input': selectItem(padName).from(midiAccess.inputs.values()),\n                        'output': selectItem(padName).from(midiAccess.outputs.values())\n                    }\n                })\n                .then(function(io){\n                    return new $.MidiAdapter(io.input, io.output);\n                })\n                .then(function(midiAdapter){\n                    return new $.Launchpad(midiAdapter);;\n                })\n                .then(function(pad){\n                    accept(pad);\n                })\n                .catch(reject);\n        }\n    };\n})(window.launchpad = window.launchpad || {});\n;;(function($){\n    $.extend = function extend(){\n        return Array.prototype.slice.call(arguments).reduce(function(result, dictionary){\n            for (var key in dictionary){\n                if (dictionary.hasOwnProperty(key) && !result.hasOwnProperty(key)) {\n                    result[key] = dictionary[key];\n                }\n            }\n            return result;\n        }, {})\n    };\n})(window.launchpad = window.launchpad || {});\n;;(function($){\n    $.connect = function(options){\n        options = $.extend(options || {}, $.defaults);\n        return new Promise(options.midiAdapterFactory.bind(options));\n    };\n})(window.launchpad = window.launchpad || {});\n;;(function($){\n    var MidiAdapter = $.MidiAdapter = function(input, output){\n        $.Observable.call(this);\n        this.input = input;\n        this.output = output;\n\n        this.input.onmidimessage = this.onMidiMessageCallback.bind(this);\n    };\n    MidiAdapter.prototype = Object.create($.Observable.prototype);\n    MidiAdapter.prototype.constructor = MidiAdapter;\n    MidiAdapter.prototype.onMidiMessageCallback = function(message){\n        var channel = message.data[0];\n        var note = message.data[1];\n        var velocity = message.data[2];\n        this.emit('input', channel, note, velocity);\n    };\n    MidiAdapter.prototype.send = function(channel, note, velocity){\n        this.output.send([channel, note, velocity]);\n    }\n})(window.launchpad = window.launchpad || {});\n;;(function($){\n    var inputHandlers = [\n        {\n            'applies': function(channel, note, velocity){ return velocity === 127; },\n            'handle': function(pad, channel, note, velocity){\n                pad.emit('press', new $.Button(channel, note, pad.midiAdapter));\n            }\n        },\n        {\n            'applies': function(channel, note, velocity){ return velocity === 0; },\n            'handle': function(pad, channel, note, velocity){\n                pad.emit('release', new $.Button(channel, note, pad.midiAdapter));\n            }\n        }\n    ];\n\n    var buttonLookups = [\n        {\n            'applies': function(args){ return args.length === 1; },\n            'lookup': function(pad, args){\n                return new $.Button(144, args[0], pad.midiAdapter);\n            }\n        },\n        {\n            'applies': function(args){ return args.length === 2; },\n            'lookup': function(pad, args){\n                return new $.Button(144, args[0] + 16 * args[1], pad.midiAdapter);\n            }\n        }\n    ];\n\n    var Pad = $.Launchpad = function(midiAdapter){\n        $.Observable.call(this);\n        this.midiAdapter = midiAdapter;\n        this.midiAdapter.on('input', this.handleInput.bind(this));\n    };\n    Pad.prototype = Object.create($.Observable.prototype);\n    Pad.prototype.constructor = Pad;\n    Pad.prototype.handleInput = function(channel, note, velocity){\n        inputHandlers\n            .filter(function(handler){ return handler.applies(channel, note, velocity); })\n            .forEach(function(handler){ handler.handle(this, channel, note, velocity); }.bind(this));\n    };\n    Pad.prototype.clear = function(){\n        this.midiAdapter.send(176, 0, 0);\n    };\n    Pad.prototype.button = function(){\n        var args = Array.prototype.slice.call(arguments);\n        return buttonLookups\n            .filter(function(buttonLookup){ return buttonLookup.applies(args); })\n            .map(function(buttonLookup){ return buttonLookup.lookup(this, args); }.bind(this))\n        [0];\n    };\n    Pad.prototype.controlButton = function(id){\n        return new $.Button(176, 104 + id, this.midiAdapter);\n    };\n})(window.launchpad = window.launchpad || {});\n;(function($){\n    $.version = '1.0.0';\n})(window.launchpad = window.launchpad || {});\n"],"sourceRoot":"/source/"}